/*
 * Project: ANE-Google-Analytics
 *
 * Author:  Alessandro Bianco
 * Website: http://alessandrobianco.eu
 * Twitter: @alebianco
 * Created: 04/06/14 16.00
 */

def os = System.getProperty("os.name").toLowerCase()[0..2]
def setupScript = file("settings.${os}.gradle") 
if (setupScript && setupScript.exists()) { 
	apply from: setupScript 
} else {
	throw new GradleException("Could not load setup script for system '${os}'.")
}

allprojects {
	project.version = productVersion
	gradle.taskGraph.whenReady {taskGraph ->
	    if (!taskGraph.hasTask(release)) {
	        version += '-SNAPSHOT'
	    }
	}
}

task release (dependsOn: 'build') {

}

task build (dependsOn: 'expandTemplates') {

}

task expandTemplates(type: Copy) {
    from('build/templates') {
        include '**/*.tmpl'
    }
    into 'temp'
	rename { file -> file[0..-6] }
    expand(project.properties + [os: os])
}

task wrapper(type: Wrapper) {
    gradleVersion = '1.11'
}